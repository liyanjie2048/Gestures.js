!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).liyanjie=t.liyanjie||{},t.liyanjie.gestures={}))}(this,function(i){"use strict";function n(t,e){var n=e.screenX-t.screenX,e=e.screenY-t.screenY;return Math.sqrt(n*n+e*e)}function r(t,e){return 180*Math.atan2(e.screenY-t.screenY,e.screenX-t.screenX)/Math.PI}i.GestureDirection=void 0,(f=i.GestureDirection||(i.GestureDirection={}))[f.up=1]="up",f[f.down=2]="down",f[f.left=4]="left",f[f.right=8]="right",f[f.vertical=3]="vertical",f[f.horizontal=12]="horizontal",Object.defineProperty(t.prototype,"currentPoints",{get:function(){var t=this;return this.movePoints.map(function(e){return{movePoint:e,startPoint:t.startPoints.find(function(t){return t.pointerId===e.pointerId})}}).filter(function(t){return void 0!==t.startPoint})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startPrimaryPoint",{get:function(){return this.startPoints.find(function(t){return t.isPrimary})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"movePrimaryPoint",{get:function(){return this.movePoints.find(function(t){return t.isPrimary})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pointerCount",{get:function(){return this.movePoints.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return(new Date).getTime()-this.startTime.getTime()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceX",{get:function(){return 0<this.currentPoints.length?this.currentPoints.map(function(t){return t.movePoint.screenX-t.startPoint.screenX}).reduce(function(t,e){return t+e})/this.currentPoints.length:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceY",{get:function(){return 0<this.currentPoints.length?this.currentPoints.map(function(t){return t.movePoint.screenY-t.startPoint.screenY}).reduce(function(t,e){return t+e})/this.currentPoints.length:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distance",{get:function(){return Math.sqrt(this.distanceX*this.distanceX+this.distanceY*this.distanceY)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return 0<this.currentPoints.length?this.currentPoints.map(function(t){return r(t.startPoint,t.movePoint)}).reduce(function(t,e){return t+e})/this.currentPoints.length:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this.angle<-45&&-135<=this.angle?i.GestureDirection.up:this.angle<-135||135<=this.angle?i.GestureDirection.left:this.angle<135&&45<=this.angle?i.GestureDirection.down:(this.angle<45&&this.angle,i.GestureDirection.right)},enumerable:!1,configurable:!0});var o=t;function t(t,e,n,i,r){this.type=t,this.target=e,this.startTime=n,this.startPoints=i,this.movePoints=r}var s=function(t,e){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)};function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function a(t,s,a,u){return new(a=a||Promise)(function(n,e){function i(t){try{o(u.next(t))}catch(t){e(t)}}function r(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(i,r)}o((u=u.apply(t,s||[])).next())})}function u(i,r){var o,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function t(n){return function(t){var e=[n,t];if(o)throw new TypeError("Generator is already executing.");for(;u=c&&e[c=0]?0:u;)try{if(o=1,s&&(a=2&e[0]?s.return:e[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,e[1])).done)return a;switch(s=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,s=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3]))u.label=e[1];else if(6===e[0]&&u.label<a[1])u.label=a[1],a=e;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(e)}}e=r.call(i,u)}catch(t){e=[6,t],s=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}}e(p,c=o);var c,h=p;function p(t,e){return c.call(this,t,e.target,e.startTime,e.startPoints,e.movePoints)||this}v.prototype.gestureStart=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return clearTimeout(this._timeout),this._awareLongPress(e),[2]})})},v.prototype.gestureMove=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return e.distance>this.maxDistance&&clearTimeout(this._timeout),[2]})})},v.prototype.gestureEnd=function(t){return a(this,void 0,void 0,function(){return u(this,function(t){return clearTimeout(this._timeout),[2]})})},v.prototype.gestureLeave=function(t){return a(this,void 0,void 0,function(){return u(this,function(t){return clearTimeout(this._timeout),[2]})})},v.prototype._awareLongPress=function(t){var e=this;this._timeout=setTimeout(function(){clearTimeout(e._timeout),t.distance<=e.maxDistance&&t.target.dispatchEvent(e._createEventArgs("longpress",t))},this.minDuration)},v.prototype._createEventArgs=function(t,e){return new CustomEvent(t,{detail:new h(t,e)})};var f=v;function v(t,e){void 0===e&&(e=10),this.minDuration=t=void 0===t?500:t,this.maxDistance=e}e(d,l=o);var l,g=d;function d(t,e){return l.call(this,t,e.target,e.startTime,e.startPoints,e.movePoints)||this}m.prototype.gestureStart=function(t){return a(this,void 0,void 0,function(){return u(this,function(t){return[2]})})},m.prototype.gestureMove=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return this._awarePan(e),[2]})})},m.prototype.gestureEnd=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return this._panStart&&this._awarePanEnd(e),this._clear(e),[2]})})},m.prototype.gestureLeave=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return this._panStart&&this._awarePanEnd(e),this._clear(e),[2]})})},m.prototype._clear=function(t){this._panStart=!1},m.prototype._awarePan=function(t){this._panStart=!0,t.target.dispatchEvent(this._createEventArgs("pan",t))},m.prototype._awarePanEnd=function(t){t.target.dispatchEvent(this._createEventArgs("panend",t))},m.prototype._createEventArgs=function(t,e){return new CustomEvent(t,{detail:new g(t,e)})};var _=m;function m(){}e(w,P=o);var P,y=w;function w(t,e,n){t=P.call(this,t,e.target,e.startTime,e.startPoints,e.movePoints)||this;return t.scale=n,t}b.prototype.gestureStart=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return e.startPoints.length<2||(this._startDistance=n(e.startPoints[0],e.startPoints[1]),this._pinchStart=!0),[2]})})},b.prototype.gestureMove=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return e.movePoints.length<2||this._pinchStart&&this._awarePinch(e),[2]})})},b.prototype.gestureEnd=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return e.movePoints.length<2?this._clear(e):(this._pinchStart&&this._awarePinchEnd(e),this._clear(e)),[2]})})},b.prototype.gestureLeave=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return e.movePoints.length<2?this._clear(e):(this._pinchStart&&this._awarePinchEnd(e),this._clear(e)),[2]})})},b.prototype._clear=function(t){this._pinchStart=!1,this._startDistance=0},b.prototype._awarePinch=function(t){this._scale=n(t.movePoints[0],t.movePoints[1])/this._startDistance,t.target.dispatchEvent(this._createEventArgs("pinch",t))},b.prototype._awarePinchEnd=function(t){this._scale=n(t.movePoints[0],t.movePoints[1])/this._startDistance,t.target.dispatchEvent(this._createEventArgs("pinchend",t)),Math.abs(1-this._scale)>this.minScale&&(1<this._scale?t.target.dispatchEvent(this._createEventArgs("pinchout",t)):this._scale<1&&t.target.dispatchEvent(this._createEventArgs("pinchin",t)))},b.prototype._createEventArgs=function(t,e){return new CustomEvent(t,{detail:new y(t,e,this._scale)})};var E=b;function b(t){this.minScale=t=void 0===t?0:t,this._scale=1}e(A,D=o);var D,T=A;function A(t,e,n){t=D.call(this,t,e.target,e.startTime,e.startPoints,e.movePoints)||this;return t.angleChange=n,t}S.prototype.gestureStart=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return e.startPoints.length<2||(this._lastAngle=r(e.movePoints[0],e.movePoints[1]),this._rotateStart=!0),[2]})})},S.prototype.gestureMove=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return e.movePoints.length<2||this._rotateStart&&this._awareRotate(e),[2]})})},S.prototype.gestureEnd=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return e.movePoints.length<2?this._clear(e):(this._rotateStart&&this._awareRotateEnd(e),this._clear(e)),[2]})})},S.prototype.gestureLeave=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return e.movePoints.length<2?this._clear(e):(this._rotateStart&&this._awareRotateEnd(e),this._clear(e)),[2]})})},S.prototype._clear=function(t){this._rotateStart=!1,this._lastAngle=0,this._angleChange=0},S.prototype._awareRotate=function(t){var e=r(t.movePoints[0],t.movePoints[1]);this._angleChange+=this._getAngleChange(e),t.target.dispatchEvent(this._createEventArgs("rotate",t))},S.prototype._awareRotateEnd=function(t){t.target.dispatchEvent(this._createEventArgs("rotateend",t)),Math.abs(this._angleChange)>this.minAngle&&(0<this._angleChange?t.target.dispatchEvent(this._createEventArgs("rotatecw",t)):t.target.dispatchEvent(this._createEventArgs("rotateccw",t)))},S.prototype._getAngleChange=function(t){var e=t-this._lastAngle;return this._lastAngle=t,180<e?e=360-e:e<-180&&(e=360+e),e},S.prototype._createEventArgs=function(t,e){return new CustomEvent(t,{detail:new T(t,e,this._angleChange)})};var L=S;function S(t){this.minAngle=t=void 0===t?10:t}e(z,x=o);var x,I=z;function z(t,e){return x.call(this,t,e.target,e.startTime,e.startPoints,e.movePoints)||this}G.prototype.gestureStart=function(t){return a(this,void 0,void 0,function(){return u(this,function(t){return[2]})})},G.prototype.gestureMove=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return this._awareSwipe(e),[2]})})},G.prototype.gestureEnd=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return this._swipeStart&&this._awareSwipeEnd(e),this._clear(e),[2]})})},G.prototype.gestureLeave=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return this._swipeStart&&this._awareSwipeEnd(e),this._clear(e),[2]})})},G.prototype._clear=function(t){this._swipeStart=!1},G.prototype._awareSwipe=function(t){t.direction==(this.direction&t.direction)&&(this._swipeStart=!0,t.target.dispatchEvent(this._createEventArgs("swipe",t)))},G.prototype._awareSwipeEnd=function(t){if(t.direction==(this.direction&t.direction)&&(t.target.dispatchEvent(this._createEventArgs("swipeend",t)),t.duration<this.maxDuration)){if(Math.abs(t.distanceY)>=this.minDistance)switch(t.direction){case i.GestureDirection.up:t.target.dispatchEvent(this._createEventArgs("swipeup",t));break;case i.GestureDirection.down:t.target.dispatchEvent(this._createEventArgs("swipedown",t))}if(Math.abs(t.distanceX)>=this.minDistance)switch(t.direction){case i.GestureDirection.left:t.target.dispatchEvent(this._createEventArgs("swipeleft",t));break;case i.GestureDirection.right:t.target.dispatchEvent(this._createEventArgs("swiperight",t))}}},G.prototype._createEventArgs=function(t,e){return new CustomEvent(t,{detail:new I(t,e)})};var X=G;function G(t,e,n){void 0===t&&(t=i.GestureDirection.horizontal),void 0===e&&(e=300),void 0===n&&(n=20),this.direction=t,this.maxDuration=e,this.minDistance=n}e(M,j=o);var j,Y=M;function M(t,e){return j.call(this,t,e.target,e.startTime,e.startPoints,e.movePoints)||this}R.prototype.gestureStart=function(t){return a(this,void 0,void 0,function(){return u(this,function(t){return clearTimeout(this._timeout),[2]})})},R.prototype.gestureMove=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return e.distance>=this.maxDistance&&clearTimeout(this._timeout),[2]})})},R.prototype.gestureEnd=function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return clearTimeout(this._timeout),this._awareTap(e),[2]})})},R.prototype.gestureLeave=function(t){return a(this,void 0,void 0,function(){return u(this,function(t){return clearTimeout(this._timeout),[2]})})},R.prototype._awareTap=function(t){var e=this;t.distance>this.maxDistance||(this.allowDoubleTap&&t.startTime.getTime()-this._lastTapTime.getTime()<this.maxDuration&&this._lastTapPoint&&n(this._lastTapPoint,t.movePoints[0])<this.maxDoubleTapDistance?(t.target.dispatchEvent(this._createEventArgs("doubletap",t)),delete this._lastTapPoint):t.duration<this.maxDuration&&(this._lastTapTime=new Date,this._lastTapPoint=t.movePoints[0],this._timeout=setTimeout(function(){clearTimeout(e._timeout),t.target.dispatchEvent(e._createEventArgs("tap",t)),delete e._lastTapPoint},this.maxDuration)))},R.prototype._createEventArgs=function(t,e){return new CustomEvent(t,{detail:new Y(t,e)})};var k=R;function R(t,e,n,i){void 0===e&&(e=10),void 0===n&&(n=!0),void 0===i&&(i=20),this.maxDuration=t=void 0===t?200:t,this.maxDistance=e,this.allowDoubleTap=n,this.maxDoubleTapDistance=i,this._lastTapTime=new Date}Object.defineProperty(C.prototype,"_hasPrimaryPoint",{get:function(){return Array.from(this._movePoints.values()).some(function(t){return t.isPrimary})},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"active",{get:function(){return this._active},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"startTime",{get:function(){return this._startTime},enumerable:!1,configurable:!0}),C.prototype.pointerDown=function(t){var e;this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation(),this.enable&&(this._active=!0,this._startTime=new Date,this._startPoints.set(t.pointerId,t),this._movePoints.set(t.pointerId,t),e=this._createEventArgs("gesturestart",t),this.recognizers.forEach(function(t){return t.gestureStart(e)}))},C.prototype.pointerMove=function(t){var e;this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation(),this.enable&&(this._active&&this._movePoints.set(t.pointerId,t),this._active)&&this._hasPrimaryPoint&&(e=this._createEventArgs("gesturemove",t),this.recognizers.forEach(function(t){return t.gestureMove(e)}))},C.prototype.pointerUp=function(t){var e;this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation(),this.enable&&(this._active&&this._hasPrimaryPoint&&(e=this._createEventArgs("gestureup",t),this.recognizers.forEach(function(t){return t.gestureEnd(e)})),this._clear(t))},C.prototype.pointerLeave=function(t){var e;this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation(),this.enable&&(this._active&&this._hasPrimaryPoint&&(e=this._createEventArgs("gestureleave",t),this.recognizers.forEach(function(t){return t.gestureLeave(e)})),this._clear(t))},C.prototype._clear=function(t){t.isPrimary&&(this._active=!1,delete this._startTime),this._startPoints.delete(t.pointerId),this._movePoints.delete(t.pointerId)},C.prototype._createEventArgs=function(t,e){return new o(t,e.target,this.startTime,Array.from(this._startPoints.values()).sort(function(t){return t.pointerId}),Array.from(this._movePoints.values()).sort(function(t){return t.pointerId}))};var O=C;function C(t,e,n,i){void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===i&&(i=!0),this.recognizers=t,this.enable=e,this.preventDefault=n,this.stopPropagation=i,this._startPoints=new Map,this._movePoints=new Map}function q(t,e,n,i,r){void 0===n&&(n=!0),void 0===i&&(i=!0),void 0===r&&(r=!0);var o=this;this.element=t,this.recognizers=e,this.enable=n,this.preventDefault=i,this.stopPropagation=r,this.gestureRecognizer=new O(e,n,i,r),t.addEventListener("pointerdown",function(t){return o.gestureRecognizer.pointerDown(t)}),t.addEventListener("pointermove",function(t){return o.gestureRecognizer.pointerMove(t)}),t.addEventListener("pointerup",function(t){return o.gestureRecognizer.pointerUp(t)}),t.addEventListener("pointerleave",function(t){return o.gestureRecognizer.pointerLeave(t)})}i.GestureEventArgs=o,i.GestureRecognizer=O,i.GestureRecognizerWrapper=q,i.LongPressGestureRecognizer=f,i.PanGestureRecognizer=_,i.PinchGestureRecognizer=E,i.RotateGestureRecognizer=L,i.SwipeGestureRecognizer=X,i.TapGestureRecognizer=k});