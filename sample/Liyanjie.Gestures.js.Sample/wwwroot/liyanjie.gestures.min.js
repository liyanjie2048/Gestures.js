!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).liyanjie=t.liyanjie||{},t.liyanjie.gestures={}))}(this,function(c){"use strict";var t;function n(t,e){var n=e.screenX-t.screenX,e=e.screenY-t.screenY;return Math.sqrt(n*n+e*e)}function i(t,e){return 180*Math.atan2(e.screenY-t.screenY,e.screenX-t.screenX)/Math.PI}c.GestureDirection=void 0,(t=c.GestureDirection||(c.GestureDirection={}))[t.up=1]="up",t[t.down=2]="down",t[t.left=4]="left",t[t.right=8]="right",t[t.vertical=3]="vertical",t[t.horizontal=12]="horizontal",c.GestureEdge=void 0,(t=c.GestureEdge||(c.GestureEdge={}))[t.none=0]="none",t[t.top=1]="top",t[t.bottom=2]="bottom",t[t.left=4]="left",t[t.right=8]="right",t[t.topLeft=5]="topLeft",t[t.topRight=9]="topRight",t[t.bottomLeft=6]="bottomLeft",t[t.bottomRight=10]="bottomRight";Object.defineProperty(e.prototype,"currentPoints",{get:function(){var t=this;return this.movePoints.map(function(e){return{movePoint:e,startPoint:t.startPoints.find(function(t){return t.pointerId===e.pointerId})}}).filter(function(t){return void 0!==t.startPoint})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startPrimaryPoint",{get:function(){return this.startPoints.find(function(t){return t.isPrimary})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movePrimaryPoint",{get:function(){return this.movePoints.find(function(t){return t.isPrimary})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pointerCount",{get:function(){return this.movePoints.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return(new Date).getTime()-this.startTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"distanceX",{get:function(){return 0<this.currentPoints.length?this.currentPoints.map(function(t){return t.movePoint.screenX-t.startPoint.screenX}).reduce(function(t,e){return t+e})/this.currentPoints.length:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"distanceY",{get:function(){return 0<this.currentPoints.length?this.currentPoints.map(function(t){return t.movePoint.screenY-t.startPoint.screenY}).reduce(function(t,e){return t+e})/this.currentPoints.length:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return Math.sqrt(this.distanceX*this.distanceX+this.distanceY*this.distanceY)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return 0<this.currentPoints.length?this.currentPoints.map(function(t){return i(t.startPoint,t.movePoint)}).reduce(function(t,e){return t+e})/this.currentPoints.length:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"direction",{get:function(){return this.angle<-45&&-135<=this.angle?c.GestureDirection.up:this.angle<-135||135<=this.angle?c.GestureDirection.left:this.angle<135&&45<=this.angle?c.GestureDirection.down:(this.angle<45&&this.angle,c.GestureDirection.right)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startEdge",{get:function(){var t;if(this.edgeDistance&&this.startPrimaryPoint)return t=c.GestureEdge.none,this.startPrimaryPoint.offsetX<this.edgeDistance&&(t|=c.GestureEdge.left),this.startPrimaryPoint.offsetY<this.edgeDistance&&(t|=c.GestureEdge.top),this.width-this.startPrimaryPoint.offsetX<this.edgeDistance&&(t|=c.GestureEdge.right),this.height-this.startPrimaryPoint.offsetY<this.edgeDistance&&(t|=c.GestureEdge.bottom),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"moveEdge",{get:function(){var t;if(this.edgeDistance&&this.movePrimaryPoint)return t=c.GestureEdge.none,this.movePrimaryPoint.offsetX<this.edgeDistance&&(t|=c.GestureEdge.left),this.movePrimaryPoint.offsetY<this.edgeDistance&&(t|=c.GestureEdge.top),this.width-this.movePrimaryPoint.offsetX<this.edgeDistance&&(t|=c.GestureEdge.right),this.height-this.movePrimaryPoint.offsetY<this.edgeDistance&&(t|=c.GestureEdge.bottom),t},enumerable:!1,configurable:!0});var r=e;function e(t,e,n,i,r,o){this.type=t,this.target=e,this.startTime=n,this.startPoints=i,this.movePoints=r,this.edgeDistance=o;t=this.target;this.width=t.offsetWidth,this.height=t.offsetHeight}Object.defineProperty(o.prototype,"_hasPrimaryPoint",{get:function(){return Array.from(this._movePoints.values()).some(function(t){return t.isPrimary})},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"active",{get:function(){return this._active},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"startTime",{get:function(){return this._startTime},enumerable:!1,configurable:!0}),o.prototype.pointerDown=function(t){var e;this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation(),this.enable&&(this._active=!0,this._startTime=(new Date).getTime(),this._startPoints.set(t.pointerId,t),this._movePoints.set(t.pointerId,t),e=this._createEventArgs("gesturestart",t),this.recognizers.forEach(function(t){return t.gestureStart(e)}))},o.prototype.pointerMove=function(t){var e;this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation(),this.enable&&(this._active&&this._movePoints.set(t.pointerId,t),this._active)&&this._hasPrimaryPoint&&(e=this._createEventArgs("gesturemove",t),this.recognizers.forEach(function(t){return t.gestureMove(e)}))},o.prototype.pointerUp=function(t){var e;this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation(),this.enable&&(this._active&&this._hasPrimaryPoint&&(e=this._createEventArgs("gestureup",t),this.recognizers.forEach(function(t){return t.gestureEnd(e)})),this._clear(t))},o.prototype.pointerLeave=function(t){var e;this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation(),this.enable&&(this._active&&this._hasPrimaryPoint&&(e=this._createEventArgs("gestureleave",t),this.recognizers.forEach(function(t){return t.gestureLeave(e)})),this._clear(t))},o.prototype._clear=function(t){t.isPrimary&&(this._active=!1,delete this._startTime),this._startPoints.delete(t.pointerId),this._movePoints.delete(t.pointerId)},o.prototype._createEventArgs=function(t,e){return new r(t,this.element,this.startTime,Array.from(this._startPoints.values()).sort(function(t){return t.pointerId}),Array.from(this._movePoints.values()).sort(function(t){return t.pointerId}),this.edgeDistance)};var h=o;function o(t,e,n,i,r,o){void 0===n&&(n=75),void 0===i&&(i=!0),void 0===r&&(r=!0),void 0===o&&(o=!0),this.element=t,this.recognizers=e,this.edgeDistance=n,this.enable=i,this.preventDefault=r,this.stopPropagation=o,this._startPoints=new Map,this._movePoints=new Map}var s=function(t,e){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)};function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function u(t,s,a,u){return new(a=a||Promise)(function(n,e){function i(t){try{o(u.next(t))}catch(t){e(t)}}function r(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(i,r)}o((u=u.apply(t,s||[])).next())})}function p(i,r){var o,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function t(n){return function(t){var e=[n,t];if(o)throw new TypeError("Generator is already executing.");for(;u=c&&e[c=0]?0:u;)try{if(o=1,s&&(a=2&e[0]?s.return:e[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,e[1])).done)return a;switch(s=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,s=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3]))u.label=e[1];else if(6===e[0]&&u.label<a[1])u.label=a[1],a=e;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(e)}}e=r.call(i,u)}catch(t){e=[6,t],s=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}}a(g,f=r);var f,l=g;function g(t,e){return f.call(this,t,e.target,e.startTime,e.startPoints,e.movePoints,e.edgeDistance)||this}d.prototype.gestureStart=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return clearTimeout(this._timeout),this._awareLongPress(e),[2]})})},d.prototype.gestureMove=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return e.distance>this.maxDistance&&clearTimeout(this._timeout),[2]})})},d.prototype.gestureEnd=function(t){return u(this,void 0,void 0,function(){return p(this,function(t){return clearTimeout(this._timeout),[2]})})},d.prototype.gestureLeave=function(t){return u(this,void 0,void 0,function(){return p(this,function(t){return clearTimeout(this._timeout),[2]})})},d.prototype._awareLongPress=function(t){var e=this;this._timeout=setTimeout(function(){clearTimeout(e._timeout),t.distance<=e.maxDistance&&t.target.dispatchEvent(e._createEventArgs("longpress",t))},this.minDuration)},d.prototype._createEventArgs=function(t,e){return new CustomEvent(t,{detail:new l(t,e)})};var v=d;function d(t,e){void 0===e&&(e=10),this.minDuration=t=void 0===t?500:t,this.maxDistance=e}a(P,m=r);var m,_=P;function P(t,e){return m.call(this,t,e.target,e.startTime,e.startPoints,e.movePoints,e.edgeDistance)||this}E.prototype.gestureStart=function(t){return u(this,void 0,void 0,function(){return p(this,function(t){return[2]})})},E.prototype.gestureMove=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return this._awarePan(e),[2]})})},E.prototype.gestureEnd=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return this._panStart&&this._awarePanEnd(e),this._clear(e),[2]})})},E.prototype.gestureLeave=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return this._panStart&&this._awarePanEnd(e),this._clear(e),[2]})})},E.prototype._clear=function(t){this._panStart=!1},E.prototype._awarePan=function(t){this._panStart=!0,t.target.dispatchEvent(this._createEventArgs("pan",t))},E.prototype._awarePanEnd=function(t){t.target.dispatchEvent(this._createEventArgs("panend",t))},E.prototype._createEventArgs=function(t,e){return new CustomEvent(t,{detail:new _(t,e)})};var y=E;function E(){}a(D,w=r);var w,b=D;function D(t,e,n){t=w.call(this,t,e.target,e.startTime,e.startPoints,e.movePoints,e.edgeDistance)||this;return t.scale=n,t}A.prototype.gestureStart=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return e.startPoints.length<2||(this._startDistance=n(e.startPoints[0],e.startPoints[1]),this._pinchStart=!0),[2]})})},A.prototype.gestureMove=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return e.movePoints.length<2||this._pinchStart&&this._awarePinch(e),[2]})})},A.prototype.gestureEnd=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return e.movePoints.length<2?this._clear(e):(this._pinchStart&&this._awarePinchEnd(e),this._clear(e)),[2]})})},A.prototype.gestureLeave=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return e.movePoints.length<2?this._clear(e):(this._pinchStart&&this._awarePinchEnd(e),this._clear(e)),[2]})})},A.prototype._clear=function(t){this._pinchStart=!1,this._startDistance=0},A.prototype._awarePinch=function(t){this._scale=n(t.movePoints[0],t.movePoints[1])/this._startDistance,t.target.dispatchEvent(this._createEventArgs("pinch",t))},A.prototype._awarePinchEnd=function(t){this._scale=n(t.movePoints[0],t.movePoints[1])/this._startDistance,t.target.dispatchEvent(this._createEventArgs("pinchend",t)),Math.abs(1-this._scale)>this.minScale&&(1<this._scale?t.target.dispatchEvent(this._createEventArgs("pinchout",t)):this._scale<1&&t.target.dispatchEvent(this._createEventArgs("pinchin",t)))},A.prototype._createEventArgs=function(t,e){return new CustomEvent(t,{detail:new b(t,e,this._scale)})};var T=A;function A(t){this.minScale=t=void 0===t?0:t,this._scale=1}a(x,G=r);var G,S=x;function x(t,e,n){t=G.call(this,t,e.target,e.startTime,e.startPoints,e.movePoints,e.edgeDistance)||this;return t.angleChange=n,t}L.prototype.gestureStart=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return e.startPoints.length<2||(this._lastAngle=i(e.movePoints[0],e.movePoints[1]),this._rotateStart=!0),[2]})})},L.prototype.gestureMove=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return e.movePoints.length<2||this._rotateStart&&this._awareRotate(e),[2]})})},L.prototype.gestureEnd=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return e.movePoints.length<2?this._clear(e):(this._rotateStart&&this._awareRotateEnd(e),this._clear(e)),[2]})})},L.prototype.gestureLeave=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return e.movePoints.length<2?this._clear(e):(this._rotateStart&&this._awareRotateEnd(e),this._clear(e)),[2]})})},L.prototype._clear=function(t){this._rotateStart=!1,this._lastAngle=0,this._angleChange=0},L.prototype._awareRotate=function(t){var e=i(t.movePoints[0],t.movePoints[1]);this._angleChange+=this._getAngleChange(e),t.target.dispatchEvent(this._createEventArgs("rotate",t))},L.prototype._awareRotateEnd=function(t){t.target.dispatchEvent(this._createEventArgs("rotateend",t)),Math.abs(this._angleChange)>this.minAngle&&(0<this._angleChange?t.target.dispatchEvent(this._createEventArgs("rotatecw",t)):t.target.dispatchEvent(this._createEventArgs("rotateccw",t)))},L.prototype._getAngleChange=function(t){var e=t-this._lastAngle;return this._lastAngle=t,180<e?e=360-e:e<-180&&(e=360+e),e},L.prototype._createEventArgs=function(t,e){return new CustomEvent(t,{detail:new S(t,e,this._angleChange)})};var j=L;function L(t){this.minAngle=t=void 0===t?10:t}a(C,O=r);var O,M=C;function C(t,e){return O.call(this,t,e.target,e.startTime,e.startPoints,e.movePoints,e.edgeDistance)||this}R.prototype.gestureStart=function(t){return u(this,void 0,void 0,function(){return p(this,function(t){return[2]})})},R.prototype.gestureMove=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return this._awareSwipe(e),[2]})})},R.prototype.gestureEnd=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return this._swipeStart&&this._awareSwipeEnd(e),this._clear(e),[2]})})},R.prototype.gestureLeave=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return this._swipeStart&&this._awareSwipeEnd(e),this._clear(e),[2]})})},R.prototype._clear=function(t){this._swipeStart=!1},R.prototype._awareSwipe=function(t){t.direction==(this.direction&t.direction)&&(this._swipeStart=!0,t.target.dispatchEvent(this._createEventArgs("swipe",t)))},R.prototype._awareSwipeEnd=function(t){if(t.direction==(this.direction&t.direction)&&(t.target.dispatchEvent(this._createEventArgs("swipeend",t)),t.duration<this.maxDuration)){if(Math.abs(t.distanceY)>=this.minDistance)switch(t.direction){case c.GestureDirection.up:t.target.dispatchEvent(this._createEventArgs("swipeup",t));break;case c.GestureDirection.down:t.target.dispatchEvent(this._createEventArgs("swipedown",t))}if(Math.abs(t.distanceX)>=this.minDistance)switch(t.direction){case c.GestureDirection.left:t.target.dispatchEvent(this._createEventArgs("swipeleft",t));break;case c.GestureDirection.right:t.target.dispatchEvent(this._createEventArgs("swiperight",t))}}},R.prototype._createEventArgs=function(t,e){return new CustomEvent(t,{detail:new M(t,e)})};var X=R;function R(t,e,n){void 0===t&&(t=c.GestureDirection.horizontal),void 0===e&&(e=300),void 0===n&&(n=20),this.direction=t,this.maxDuration=e,this.minDistance=n}a(k,Y=r);var Y,I=k;function k(t,e){return Y.call(this,t,e.target,e.startTime,e.startPoints,e.movePoints,e.edgeDistance)||this}z.prototype.gestureStart=function(t){return u(this,void 0,void 0,function(){return p(this,function(t){return clearTimeout(this._timeout),[2]})})},z.prototype.gestureMove=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return e.distance>=this.maxDistance&&clearTimeout(this._timeout),[2]})})},z.prototype.gestureEnd=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){return clearTimeout(this._timeout),this._awareTap(e),[2]})})},z.prototype.gestureLeave=function(t){return u(this,void 0,void 0,function(){return p(this,function(t){return clearTimeout(this._timeout),[2]})})},z.prototype._awareTap=function(t){var e=this;t.distance>this.maxDistance||(this.allowDoubleTap&&t.startTime-this._lastTapTime.getTime()<this.maxDuration&&this._lastTapPoint&&n(this._lastTapPoint,t.movePoints[0])<this.maxDoubleTapDistance?(t.target.dispatchEvent(this._createEventArgs("doubletap",t)),delete this._lastTapPoint):t.duration<this.maxDuration&&(this._lastTapTime=new Date,this._lastTapPoint=t.movePoints[0],this._timeout=setTimeout(function(){clearTimeout(e._timeout),t.target.dispatchEvent(e._createEventArgs("tap",t)),delete e._lastTapPoint},this.maxDuration)))},z.prototype._createEventArgs=function(t,e){return new CustomEvent(t,{detail:new I(t,e)})};var q=z;function z(t,e,n,i){void 0===e&&(e=10),void 0===n&&(n=!0),void 0===i&&(i=20),this.maxDuration=t=void 0===t?200:t,this.maxDistance=e,this.allowDoubleTap=n,this.maxDoubleTapDistance=i,this._lastTapTime=new Date}c.GestureEventArgs=r,c.GestureRecognizer=h,c.LongPressGestureEventArgs=l,c.LongPressGestureRecognizer=v,c.PanGestureEventArgs=_,c.PanGestureRecognizer=y,c.PinchGestureEventArgs=b,c.PinchGestureRecognizer=T,c.RotateGestureEventArgs=S,c.RotateGestureRecognizer=j,c.SwipeGestureEventArgs=M,c.SwipeGestureRecognizer=X,c.TapGestureEventArgs=I,c.TapGestureRecognizer=q,c.registerGestures=function(t,e,n,i,r,o){var s,a,u;if(void 0===n&&(n=75),void 0===i&&(i=!0),void 0===r&&(r=!0),void 0===o&&(o=!0),t instanceof Element?s=t:"string"==typeof t&&(s=document.querySelector(t)),s)return Array.isArray(e)?a=e:(a=[],e.tap&&a.push(new q(null!=(t=e.tap.maxDuration)?t:200,null!=(t=e.tap.maxDistance)?t:10,null==(t=e.tap.allowDoubleTap)||t,null!=(t=e.tap.maxDoubleTapDistance)?t:20)),e.longPress&&a.push(new v(null!=(t=e.longPress.minDuration)?t:500,null!=(t=e.longPress.maxDistance)?t:10)),e.pan&&a.push(new y),e.swipe&&a.push(new X(null!=(t=e.swipe.direction)?t:c.GestureDirection.horizontal,null!=(t=e.swipe.maxDuration)?t:300,null!=(t=e.swipe.minDistance)?t:20)),e.rotate&&a.push(new j(null!=(t=e.rotate.minAngle)?t:10)),e.pinch&&a.push(new T(null!=(t=e.pinch.minScale)?t:0))),u=new h(s,a,n,i,r,o),document.addEventListener("pointerdown",function(t){return s.contains(t.target)&&u.pointerDown(t)}),document.addEventListener("pointermove",function(t){return s.contains(t.target)?u.pointerMove(t):u.pointerLeave(t)}),document.addEventListener("pointerup",function(t){return s.contains(t.target)&&u.pointerUp(t)}),u}});